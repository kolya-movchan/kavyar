(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5888],{22467:function(t,e,n){"use strict";n.r(e),n.d(e,{ERROR_API_KEY_EXPIRED:function(){return T},ERROR_API_KEY_INVALID:function(){return v},ERROR_API_KEY_MISSING:function(){return I},ERROR_BAD_REQUEST_FORMAT:function(){return h},ERROR_BAD_RESPONSE_FORMAT:function(){return f},ERROR_CLIENT_TIMEOUT:function(){return c},ERROR_CSP_BLOCK:function(){return E},ERROR_FORBIDDEN_ENDPOINT:function(){return p},ERROR_FORBIDDEN_HEADER:function(){return D},ERROR_FORBIDDEN_ORIGIN:function(){return S},ERROR_GENERAL_SERVER_FAILURE:function(){return N},ERROR_INSTALLATION_METHOD_RESTRICTED:function(){return d},ERROR_INTEGRATION_FAILURE:function(){return O},ERROR_NETWORK_ABORT:function(){return a},ERROR_NETWORK_CONNECTION:function(){return R},ERROR_RATE_LIMIT:function(){return A},ERROR_SCRIPT_LOAD_FAIL:function(){return L},ERROR_SERVER_TIMEOUT:function(){return y},ERROR_SUBSCRIPTION_NOT_ACTIVE:function(){return _},ERROR_TOKEN_EXPIRED:function(){return w},ERROR_TOKEN_INVALID:function(){return P},ERROR_TOKEN_MISSING:function(){return m},ERROR_UNSUPPORTED_VERSION:function(){return l},ERROR_WRONG_REGION:function(){return s},default:function(){return G},defaultEndpoint:function(){return i},defaultScriptUrlPattern:function(){return b},defaultTlsEndpoint:function(){return u},load:function(){return B}});var r=function(){return r=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t},r.apply(this,arguments)};Object.create;Object.create;function o(t){for(var e="",n=0;n<t.length;++n)if(n>0){var r=t[n].toLowerCase();r!==t[n]?e+=" ".concat(r):e+=t[n]}else e+=t[n].toUpperCase();return e}var i={default:"endpoint"},u={default:"tlsEndpoint"},c="Client timeout",R="Network connection error",a="Network request aborted",f="Response cannot be parsed",E="Blocked by CSP",s=o("WrongRegion"),_=o("SubscriptionNotActive"),l=o("UnsupportedVersion"),d=o("InstallationMethodRestricted"),p=o("HostnameRestricted"),O=o("IntegrationFailed"),I="API key required",v="API key not found",T="API key expired",h="Request cannot be parsed",N="Request failed",y="Request failed to process",A="Too many requests, rate limit exceeded",S="Not available for this origin",D="Not available with restricted header",m=I,P=v,w=T,g="9319";function C(t,e){var n=[];return function(t,e){var n,r,o=(r=function(t,e,n){if(n||2===arguments.length)for(var r,o=0,i=e.length;o<i;o++)!r&&o in e||(r||(r=Array.prototype.slice.call(e,0,o)),r[o]=e[o]);return t.concat(r||Array.prototype.slice.call(e))}([],t,!0),{current:function(){return r[0]},postpone:function(){var t=r.shift();void 0!==t&&r.push(t)},exclude:function(){r.shift()}}),i=(100,3e3,n=0,function(){return Math.random()*Math.min(3e3,100*Math.pow(2,n++))}),u=o.current();if(void 0===u)return Promise.reject(new TypeError("The list of script URL patterns is empty"));var c=function(t,n){return e(t).catch((function(t){if(n+1>=5)throw t;!function(t){if(!(t instanceof Error))return!1;var e=t.message;return e===E||e===g}(t)?o.postpone():o.exclude();var e,r=o.current();if(void 0===r)throw t;return(e=i(),new Promise((function(t){return setTimeout(t,e)}))).then((function(){return c(r,n+1)}))}))};return c(u,0)}(t,(function(t){var r=new Date,o=function(){return n.push({url:t,startedAt:r,finishedAt:new Date})},i=e(t);return i.then(o,o),i})).then((function(t){return[t,{attempts:n}]}))}var U="https://fpnpmcdn.net/v<version>/<apiKey>/loader_v<loaderVersion>.js",b=U,L="Failed to load the JS script of the agent";function B(t){var e;t.scriptUrlPattern;var n=t.token,o=t.apiKey,i=void 0===o?n:o,u=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"===typeof Object.getOwnPropertySymbols){var o=0;for(r=Object.getOwnPropertySymbols(t);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(t,r[o])&&(n[r[o]]=t[r[o]])}return n}(t,["scriptUrlPattern","token","apiKey"]),c=null!==(e=function(t,e){return function(t,e){return Object.prototype.hasOwnProperty.call(t,e)}(t,e)?t[e]:void 0}(t,"scriptUrlPattern"))&&void 0!==e?e:U;return Promise.resolve().then((function(){if(!i||"string"!=typeof i)throw new Error(I);return C(function(t,e){return(Array.isArray(t)?t:[t]).map((function(t){return function(t,e){var n=encodeURIComponent;return t.replace(/<[^<>]+>/g,(function(t){return"<version>"===t?"3":"<apiKey>"===t?n(e):"<loaderVersion>"===t?n("3.8.2"):t}))}(String(t),e)}))}(c,i),F).catch(K)})).then((function(t){var e=t[0],n=t[1];return e.load(r(r({},u),{ldi:n}))}))}function F(t){return function(t,e,n,r){var o,i=document,u="securitypolicyviolation",c=function(e){var n=new URL(t,location.href),r=e.blockedURI;r!==n.href&&r!==n.protocol.slice(0,-1)&&r!==n.origin||(o=e,R())};i.addEventListener(u,c);var R=function(){return i.removeEventListener(u,c)};return Promise.resolve().then(e).then((function(t){return R(),t}),(function(t){return new Promise((function(t){return setTimeout(t)})).then((function(){if(R(),o)return function(){throw new Error(E)}();throw t}))}))}(t,(function(){return function(t){return new Promise((function(e,n){var r=document.createElement("script"),o=function(){var t;return null===(t=r.parentNode)||void 0===t?void 0:t.removeChild(r)},i=document.head||document.getElementsByTagName("head")[0];r.onload=function(){o(),e()},r.onerror=function(){o(),n(new Error(L))},r.async=!0,r.src=t,i.appendChild(r)}))}(t)})).then(j)}function j(){var t=window,e="__fpjs_p_l_b",n=t[e];if(function(t,e){var n,r=null===(n=Object.getOwnPropertyDescriptor)||void 0===n?void 0:n.call(Object,t,e);(null==r?void 0:r.configurable)?delete t[e]:r&&!r.writable||(t[e]=void 0)}(t,e),"function"!=typeof(null==n?void 0:n.load))throw new Error(g);return n}function K(t){throw t instanceof Error&&t.message===g?new Error(L):t}var G={load:B,defaultScriptUrlPattern:U,ERROR_SCRIPT_LOAD_FAIL:L,ERROR_API_KEY_EXPIRED:T,ERROR_API_KEY_INVALID:v,ERROR_API_KEY_MISSING:I,ERROR_BAD_REQUEST_FORMAT:h,ERROR_BAD_RESPONSE_FORMAT:f,ERROR_CLIENT_TIMEOUT:c,ERROR_CSP_BLOCK:E,ERROR_FORBIDDEN_ENDPOINT:p,ERROR_FORBIDDEN_HEADER:D,ERROR_FORBIDDEN_ORIGIN:S,ERROR_GENERAL_SERVER_FAILURE:N,ERROR_INSTALLATION_METHOD_RESTRICTED:d,ERROR_INTEGRATION_FAILURE:O,ERROR_NETWORK_ABORT:a,ERROR_NETWORK_CONNECTION:R,ERROR_RATE_LIMIT:A,ERROR_SERVER_TIMEOUT:y,ERROR_SUBSCRIPTION_NOT_ACTIVE:_,ERROR_TOKEN_EXPIRED:T,ERROR_TOKEN_INVALID:v,ERROR_TOKEN_MISSING:I,ERROR_UNSUPPORTED_VERSION:l,ERROR_WRONG_REGION:s,defaultEndpoint:i,defaultTlsEndpoint:u}},10646:function(t){t.exports=function(){"use strict";function t(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)t[r]=n[r]}return t}function e(n,r){function o(e,o,i){if("undefined"!==typeof document){"number"===typeof(i=t({},r,i)).expires&&(i.expires=new Date(Date.now()+864e5*i.expires)),i.expires&&(i.expires=i.expires.toUTCString()),e=encodeURIComponent(e).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape);var u="";for(var c in i)i[c]&&(u+="; "+c,!0!==i[c]&&(u+="="+i[c].split(";")[0]));return document.cookie=e+"="+n.write(o,e)+u}}function i(t){if("undefined"!==typeof document&&(!arguments.length||t)){for(var e=document.cookie?document.cookie.split("; "):[],r={},o=0;o<e.length;o++){var i=e[o].split("="),u=i.slice(1).join("=");try{var c=decodeURIComponent(i[0]);if(r[c]=n.read(u,c),t===c)break}catch(R){}}return t?r[t]:r}}return Object.create({set:o,get:i,remove:function(e,n){o(e,"",t({},n,{expires:-1}))},withAttributes:function(n){return e(this.converter,t({},this.attributes,n))},withConverter:function(n){return e(t({},this.converter,n),this.attributes)}},{attributes:{value:Object.freeze(r)},converter:{value:Object.freeze(n)}})}return e({read:function(t){return'"'===t[0]&&(t=t.slice(1,-1)),t.replace(/(%[\dA-F]{2})+/gi,decodeURIComponent)},write:function(t){return encodeURIComponent(t).replace(/%(2[346BF]|3[AC-F]|40|5[BDE]|60|7[BCD])/g,decodeURIComponent)}},{path:"/"})}()},75888:function(t,e,n){"use strict";var r=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(o,i){function u(t){try{R(r.next(t))}catch(e){i(e)}}function c(t){try{R(r.throw(t))}catch(e){i(e)}}function R(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(u,c)}R((r=r.apply(t,e||[])).next())}))};Object.defineProperty(e,"__esModule",{value:!0}),e.recure=e.EventType=void 0;const o=n(22467),i=n(10646),u="recureSendingEventsBlocked",c=1e3;var R;function a(t){return t?new Date(t).getTime()/c:(new Date).getTime()/c}function f(t,e){return r(this,void 0,void 0,(function*(){const n=i.get(t),u=localStorage.getItem(t);if(n)return u||E(t,n),n;if(u)return n||s(t,u,120),u;const c=yield function(t,e){return r(this,void 0,void 0,(function*(){const n=yield fetch(t,{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json","x-api-key":e}});return(yield n.json()).apiKey}))}("https://api.recure.ai/api/event_handler/get_api_key/",e);if(c.startsWith("MATE"))return"mate_absent_visitor_id";const R=yield function(t){return r(this,void 0,void 0,(function*(){const e=yield o.default.load({apiKey:t});return yield e.get()}))}(c);return s(t,R.visitorId,120),E(t,R.visitorId),R.visitorId}))}function E(t,e){localStorage.removeItem(t),localStorage.setItem(t,e)}function s(t,e,n){i.set(t,e,{expires:n,path:""})}function _(t){E(u,t.toISOString()),s(u,"true",t)}function l(){const t=i.get(u),e=localStorage.getItem(u),n=new Date((new Date).getTime()+3e5);if(!t&&!e)return _(n),!0;if(!t&&e){return function(t){const e=a(t);return function(t,e){return(t-e)/60}(a(),e)}(e)>0?(_(n),!0):(function(t){const e=new Date(t);s(u,"true",e)}(e),!1)}return!1}!function(t){t.LOGIN="LOGIN",t.SIGN_UP="SIGN_UP",t.PAGE="PAGE",t.FREE_TRIAL_STARTED="FREE_TRIAL_STARTED",t.FREE_TRIAL_ENDED="FREE_TRIAL_ENDED",t.SUBSCRIPTION_STARTED="SUBSCRIPTION_STARTED",t.SUBSCRIPTION_ENDED="SUBSCRIPTION_ENDED"}(R=e.EventType||(e.EventType={})),e.recure=function(t,e,n,o){return r(this,void 0,void 0,(function*(){if(n!==R.PAGE||l())try{const i=yield function(t,e,n,o){return r(this,void 0,void 0,(function*(){const r=yield f("visitorId",t);return{userId:e.toString(),provider:"recure-pixel",type:n,visitorId:r,timestamp:(new Date).toISOString(),eventOptions:o}}))}(e,t,n,o);yield fetch("https://api.recure.ai/api/event_handler/",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json","x-api-key":e},body:JSON.stringify(i)})}catch(i){throw i}}))}}}]);
//# sourceMappingURL=5888-88970865a2cddbe6.js.map