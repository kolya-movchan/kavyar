"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6253],{58293:function(e,t,n){n.d(t,{MY:function(){return w},Mi:function(){return p},Nl:function(){return s},O4:function(){return d},_r:function(){return m},bJ:function(){return f},gA:function(){return g},oF:function(){return u},pE:function(){return l},px:function(){return _},qJ:function(){return h},rO:function(){return v}});var r=n(20268),a=n(69854),i=n(22831),o=n(8151),s=function(e){return(null===e||void 0===e?void 0:e.role)===r._bo.Admin},d=function(e,t){return t?e.reduce((function(e,n){return n.id>t?e+1:e}),0):0},u=function(e){var t=e.lastSentMessageId,n=e.lastReadMessageId;return!!t&&(!n||Number(n)<Number(t))},c=function(e){var t=e.myParticipant;return Boolean((null===t||void 0===t?void 0:t.isFavourite)&&!(null===t||void 0===t?void 0:t.archivedAt))},l=function(e){var t=e.myParticipant;return null===t||void 0===t?void 0:t.archivedAt},f=function(e){return u(e)&&!l(e)},h=function(e,t){switch(t){case a.Iy.Unread:return e.filter(f);case a.Iy.Favourite:return e.filter(c);case a.Iy.Archived:return e.filter(l);case a.Iy.All:default:return e.filter((function(e){return!l(e)}))}},p=function(e,t){return e!==a.M2.Mobile&&t!==a.lR.Chat},m=function(e){switch(e.trim()){case"+":return"\u2795";case"-":return"\u2796";default:return e}},v=function(e){var t=e.isMessageSender,n=e.isHeadingMessage,r=e.isChatWideMode;return t&&!n&&!r},g=function(e){var t=e.thread,n=e.threadMessages,a=e.chat,s=e.participant,d=a.id,u=a.name,c=a.accessType===r.$CB.Public,l=s.id===t.senderId;if(c&&!l&&!n.some((function(e){return e.senderId!==t.senderId}))){var f=t.createdAt,h=Date.now(),p=Math.ceil((h-f)/o.EB);i.w.sendEvent(i.w.events.sandboxChatQuestionAnswered,{chatId:d,chatName:u,senderId:s.id,senderRole:s.role,threadId:t.id,questionTimestamp:new Date(f),answerTimestamp:new Date(h),responseTimeInMinutes:p})}},_=function(e){return(null!==e&&void 0!==e?e:[]).map((function(e){return e.uploadFile})).filter((function(e){return Boolean(e)}))},w=function(e,t){return e.length&&t?e.some((function(e){return e.id===t}))?t:e.reduce((function(e,n){return t-e.id<t-n.id?e:n})).id:null}},69854:function(e,t,n){var r,a,i,o,s,d,u,c,l,f,h,p;n.d(t,{Cs:function(){return r},Gk:function(){return f},H$:function(){return d},Iy:function(){return u},M2:function(){return l},PD:function(){return o},Y7:function(){return h},a9:function(){return s},cd:function(){return p},i_:function(){return i},lR:function(){return c}}),function(e){e.Message="Message",e.Thread="Thread",e.OpenQuestion="OpenQuestion",e.OpenQuestionAnswer="OpenQuestionAnswer",e.Poll="Poll",e.PollAnswer="PollAnswer",e.SystemMessage="SystemMessage"}(r||(r={})),function(e){e.Chat="Chat",e.Thread="Thread",e.OpenQuestion="OpenQuestion"}(a||(a={})),function(e){e.Message="Message",e.Thread="Thread",e.OpenQuestion="OpenQuestion",e.OpenQuestionAnswer="OpenQuestionAnswer",e.Poll="Poll",e.PollAnswer="PollAnswer",e.AbstractMessage="AbstractMessage",e.PollOption="PollOption",e.SystemMessage="SystemMessage"}(i||(i={})),function(e){e.GroupChat="GroupChat",e.PrivateChat="PrivateChat"}(o||(o={})),function(e){e.UnknownMessageType="Unknown message type"}(s||(s={})),function(e){e[e.LastReadMessage=0]="LastReadMessage",e[e.OpenedThread=1]="OpenedThread",e[e.ClosedThread=2]="ClosedThread",e[e.Bottom=3]="Bottom",e[e.ScrollingToBottom=4]="ScrollingToBottom",e[e.FreeReading=5]="FreeReading"}(d||(d={})),function(e){e[e.All=0]="All",e[e.Unread=1]="Unread",e[e.Archived=2]="Archived",e[e.Favourite=3]="Favourite"}(u||(u={})),function(e){e[e.ChatsSelector=0]="ChatsSelector",e[e.Extensions=1]="Extensions",e[e.Chat=2]="Chat"}(c||(c={})),function(e){e[e.Mobile=0]="Mobile",e[e.Tablet=1]="Tablet",e[e.Desktop=2]="Desktop"}(l||(l={})),function(e){e.Bottom="bottom",e.Top="top"}(f||(f={})),function(e){e.Date="Date&time",e.IsCorrect="Correct/wrong"}(h||(h={})),function(e){e.Statistics="statistics",e.Guidelines="guidelines"}(p||(p={}))},15265:function(e,t,n){n.d(t,{M:function(){return l}});var r=n(16072),a=n(67294),i=n(69854),o=n(20268),s=n(64277),d=n(33145),u=n(71317),c=n(97883),l=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=(0,u.b)(),l=Array.isArray(e)?e:[e],f=(0,o.$_2)({skip:!c.isBrowser,variables:{chatIds:l},onSubscriptionData:function(e){var n=e.client.cache,a=e.subscriptionData.data,u=null===a||void 0===a?void 0:a.chatMessageCreated;if(u)switch(u.__typename){case i.Cs.Thread:case i.Cs.OpenQuestion:case i.Cs.SystemMessage:case i.Cs.Poll:(0,d.ER)(n,u,t.hasMoreNewerMessages),(0,d.AT)(n,u);break;case i.Cs.Message:var c={message:u,fragment:o.xtX,fragmentName:i.i_.Message},l={type:i.Cs.Thread,fieldToUpdate:"messages"};(0,d.vL)(n,l,c);break;case i.Cs.OpenQuestionAnswer:var f={message:u,fragment:o.a85,fragmentName:i.i_.OpenQuestionAnswer},h={type:i.Cs.OpenQuestion,fieldToUpdate:"answers"};(0,d.vL)(n,h,f);break;case i.Cs.PollAnswer:var p={message:u,fragment:o.H_3,fragmentName:i.i_.PollAnswer},m={type:i.Cs.Poll,fieldToUpdate:"votes"};(0,d.vL)(n,m,p);break;default:s.P.captureException(new Error(i.a9.UnknownMessageType),{logLevel:r.LogLevels.Error,fields:u})}}}).error;(0,a.useEffect)((function(){f&&n({logMessage:"Chat subscription error in chatMessageCreated",error:f})}),[f,n])}},71317:function(e,t,n){n.d(t,{b:function(){return c}});var r=n(67294),a=n(16072),i=n(64277),o=n(34145),s=n(98698),d=n(34038),u=n(30155),c=function(){var e=(0,o.ZW)().showMessage,t=(0,d.$G)([u.WY.chat]).t;return(0,r.useCallback)((function(n){var r=n.error,o=n.logMessage;i.P.captureException(r,{logMessage:o,logLevel:a.LogLevels.Error}),e({type:s.oK.error,heading:t("".concat(u.WY.chat,":subscription_error.please_reload_page")),text:t("".concat(u.WY.chat,":subscription_error.something_went_wrong"))})}),[e,t])}},33145:function(e,t,n){n.d(t,{AT:function(){return l},ER:function(){return s},Gy:function(){return h},JU:function(){return u},KW:function(){return c},vL:function(){return d},x3:function(){return f}});var r=n(14924),a=n(29815),i=n(20268),o=n(69854),s=function(e,t,n){!function(e){var t=e.store,n=e.message,r=t.readQuery({query:i.vwF,variables:{chatId:n.chatId}});(null===r||void 0===r?void 0:r.latestThreads)&&(r.latestThreads.some((function(e){return e.id===n.id}))||t.writeQuery({query:i.vwF,variables:{chatId:n.chatId},data:{latestThreads:(0,a.Z)(r.latestThreads).concat([n])}}))}({store:e,message:t}),!1===n&&function(e){var t=e.store,n=e.message,r=t.readQuery({query:i.TXZ,variables:{chatId:n.chatId}});(null===r||void 0===r?void 0:r.chatThreads)&&(r.chatThreads.some((function(e){return e.id===n.id}))||t.writeQuery({query:i.TXZ,variables:{chatId:n.chatId},data:{chatThreads:(0,a.Z)(r.chatThreads).concat([n])}}))}({store:e,message:t})},d=function(e,t,n){var i=n.message,o=n.fragment,s=n.fragmentName,d=t.type,u=t.fieldToUpdate,c=e.identify({__typename:d,id:i.threadId});e.modify({id:c,fields:(0,r.Z)({},u,(function(t,n){var r=n.readField,d=e.writeFragment({data:i,fragment:o,fragmentName:s});return t.some((function(e){return r("id",e)===i.id}))?t:(0,a.Z)(t).concat([d])}))})},u=function(e,t){var n=e.readQuery({query:i.TXZ,variables:{chatId:t.chatId}});if(null===n||void 0===n?void 0:n.chatThreads){var r=n.chatThreads.filter((function(e){return e.id!==t.id}));e.writeQuery({query:i.TXZ,variables:{chatId:t.chatId},data:{chatThreads:r}})}},c=function(e,t,n){var r=e.identify({__typename:t,id:n.threadId});e.modify({id:r,fields:{messages:function(e,t){var r=t.readField;return e.filter((function(e){return r("id",e)!==n.id}))}}})},l=function(e,t){var n=e.identify({__typename:i.z_3.PrivateChat,id:t.chatId}),r=e.identify({__typename:i.z_3.GroupChat,id:t.chatId});(n||r)&&(e.modify({id:n,fields:{lastActionTime:function(){return new Date(t.createdAt)},lastSentMessageId:function(){return t.id}}}),e.modify({id:r,fields:{lastActionTime:function(){return new Date(t.createdAt)},lastSentMessageId:function(){return t.id}}}))},f=function(e,t){e.modify({id:e.identify({__typename:o.PD.GroupChat,id:t.chatId}),fields:{lastReadMessageId:function(){return t.id}}}),e.modify({id:e.identify({__typename:o.PD.PrivateChat,id:t.chatId}),fields:{lastReadMessageId:function(){return t.id}}})},h=function(e,t,n){e.modify({id:e.identify({__typename:t,id:n.threadId}),fields:{lastReadMessageId:function(){return n.id}}})}},34610:function(e,t,n){n.d(t,{f:function(){return s}});var r=n(26042),a=n(69396),i=n(85893),o=(n(67294),n(94923)),s=function(e){return(0,i.jsx)(o.s,(0,a.Z)((0,r.Z)({width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},e),{children:(0,i.jsx)("path",{d:"M5.763 17H20V5H4V18.385L5.763 17ZM6.455 19L2 22.5V4C2 3.73478 2.10536 3.48043 2.29289 3.29289C2.48043 3.10536 2.73478 3 3 3H21C21.2652 3 21.5196 3.10536 21.7071 3.29289C21.8946 3.48043 22 3.73478 22 4V18C22 18.2652 21.8946 18.5196 21.7071 18.7071C21.5196 18.8946 21.2652 19 21 19H6.455Z",fill:"currentColor"})}))}},22831:function(e,t,n){n.d(t,{w:function(){return i}});var r=n(54026),a=n(2021),i={sendEvent:function(e,t){var n="chat_".concat(e);(0,r.jq)(n,t),a.c.getInstance().sendEvent(n,t)},events:{messageCreated:"message_created",openQuestionCreated:"open_question_created",openQuestionAnswered:"open_question_answered",pollCreated:"poll_created",pollAnswered:"poll_answered",openQuestionAnswerRated:"open_question_answer_rated",guidelineMessageSentToChat:"guideline_message_sent_to_chat",wrapCodeUsed:"wrap_code_used",sortedByCorrectness:"sorted_by_correctness,",selectorTabChanged:"selector_tab_changed",participantJoined:"participant_joined",participantLeft:"participant_left",mediaFileAttached:"media_file_attached",mediaFileRemoved:"media_file_removed",mediaFileUploadFailed:"media_file_upload_failed",mediaFilePreviewOpened:"media_file_preview_opened",mentionButtonUsed:"mention_button_used",mentionAdded:"mention_added",editProfileButtonClicked:"edit_profile_button_clicked",participantAvatarUpdated:"participant_avatar_updated",sandboxChatQuestionAnswered:"sandbox_chat_question_answered"}}}}]);
//# sourceMappingURL=6253-52d0b2c35353eea2.js.map